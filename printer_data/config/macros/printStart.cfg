[gcode_macro PRINT_START]
gcode:
    # --- Parameters ---
    {% set BED_TEMP = params.BED_TEMP|default(60)|float %}
    {% set EXTRUDER_TEMP = params.EXTRUDER_TEMP|default(200)|float %}
    {% set CHAMBER_TEMP = params.CHAMBER_TEMP|default(0)|float %}

    # --- 0. Setup & Debug ---
    M118 >>> PRINT_START Initialized (Mercury One.1 Pro)
    M118 Target Bed: {BED_TEMP}C
    M118 Target Nozzle: {EXTRUDER_TEMP}C
    
    G90 ; Absolute positioning
    M220 S100 ; Reset Feedrate
    M221 S100 ; Reset Flowrate
    G92 E0 ; Reset Extruder

    # --- 1. System Warmup ---
    status_heating                   ; LED status (Optional)
    M117 Preheating...
    M140 S{BED_TEMP}                 ; Start heating bed (No wait yet)
    M104 S150                        ; Preheat nozzle to 150C (Softens tip, no ooze)

    # --- 2. Homing ---
    status_homing                    ; LED status (Optional)
    M117 Homing...
    # We use a single full home here (consolidated from your old split logic)
    {% if not 'xyz' in printer.toolhead.homed_axes %}
        G28
    {% endif %}
    
    # Move to Center & High Z (Avoid cooking the probe near the bed)
    G0 X117.5 Y117.5 Z100 F10000 

    # --- 3. Heat Soak ---
    M117 Heating Bed...
    M190 S{BED_TEMP}                 ; Wait for bed to reach temp
    M118 Bed temp reached.

    # --- 4. Z-Tilt & Leveling ---
    status_leveling                  ; LED status (Optional)
    M117 Leveling Gantry...
    M118 Aligning Bed (Z_TILT)...
    
    Z_TILT_ADJUST                    ; Align Independent Dual Z motors
    M118 Z-Tilt Complete.

    # --- 5. Re-Home Z (Mandatory) ---
    # The bed angle changed, so the old Z=0 is wrong. We must re-home Z.
    status_homing
    M118 Re-homing Z...
    G28 Z                            

    # --- 6. Bed Mesh ---
    status_meshing                   ; LED status (Optional)
    M117 Meshing...
    M118 Generating Adaptive Mesh...
    BED_MESH_CLEAR
    BED_MESH_CALIBRATE ADAPTIVE=1    ; Only mesh the print area
    M118 Mesh generated.

    # --- 7. Final Heating ---
    status_heating
    # Move near purge area (Front Left) to catch ooze
    G0 X5 Y5 Z10 F10000              
    
    M117 Final Heating...
    M118 Heating Nozzle to {EXTRUDER_TEMP}C...
    M104 S{EXTRUDER_TEMP}            ; Set final temp
    
    # "Smart Wait" - Start as soon as we hit target (or if slightly over)
    TEMPERATURE_WAIT SENSOR=extruder MINIMUM={EXTRUDER_TEMP} MAXIMUM={EXTRUDER_TEMP+5}
    M118 Nozzle temp reached.

    # --- 8. Printing ---
    status_printing                  ; LED status (Optional)
    SKEW_PROFILE LOAD=Calilantern    ; Load Skew Profile
    M118 Skew Profile Loaded.
    
    M117 Purging...
    ZEROG_PURGE                      ; Run your custom purge
    
    M117 Printing...
    M118 >>> PRINT START COMPLETE.

    # --- 9. Cleanup Display ---
    # This waits 10 seconds, then runs the 'clear_display' macro to wipe the screen.
    UPDATE_DELAYED_GCODE ID=clear_display DURATION=10